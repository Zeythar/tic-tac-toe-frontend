<main
  class="main"
  [class.my-x]="mySymbol() === 'X' || mySymbol() === 'x'"
  [class.my-o]="mySymbol() === 'O' || mySymbol() === 'o'"
>
  <div class="content">
    <!-- Home screen: choose how to play -->
    <app-home *ngIf="stage() === 'welcome'" (playAgainstFriend)="onModeSelected($event)"></app-home>

    <!-- Connecting screen: establishing server connection -->
    <app-connecting *ngIf="stage() === 'connecting'"></app-connecting>

    <!-- AI settings screen -->
    <app-ai-settings
      *ngIf="stage() === 'ai-settings'"
      (start)="onAiStart($event)"
      (back)="stage.set('welcome')"
    ></app-ai-settings>

    <!-- Share link screen -->
    <app-share-link
      *ngIf="stage() === 'share'"
      [shareLink]="shareLink()"
      [copied]="copied()"
      (copyLink)="copyShareLink()"
      (back)="goHome()"
    ></app-share-link>

    <!-- Game board: active game -->
    <app-game-board
      *ngIf="stage() === 'in-game'"
      [board]="board()"
      [mySymbol]="mySymbol()"
      [currentTurn]="currentTurn()"
      [isGameOver]="isGameOver()"
      [winner]="winner()"
      [opponentPresent]="opponentPresent()"
      [disconnectedPlayerId]="disconnectedPlayerId()"
      [countdownSeconds]="countdownSeconds()"
      [myTurnCountdown]="myTurnCountdown()"
      [opponentTurnCountdown]="opponentTurnCountdown()"
      [moveError]="moveError()"
      [gameMode]="playMode()"
      (cellClick)="makeMove($event)"
      (back)="goHome()"
      (reset)="onReset()"
    ></app-game-board>
  </div>
</main>
<router-outlet />

<app-toast />

<app-modal
  (createGame)="createGame()"
  (rematch)="onRematch()"
  (offerRematch)="onOfferRematch()"
  (acceptRematch)="onAcceptRematch()"
  (declineRematch)="onDeclineRematch()"
  (goHome)="goHome()"
  (dismiss)="dismissSystemModal()"
></app-modal>
